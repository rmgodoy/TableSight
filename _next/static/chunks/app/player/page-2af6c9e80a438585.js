(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{188:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155),s=a(2115),o=a(7822);function l(e){let{sessionId:t}=e,[a,l]=(0,s.useState)([]),[i,n]=(0,s.useState)([]),[d,c]=(0,s.useState)(null),[h,p]=(0,s.useState)(1),[u,y]=(0,s.useState)({x:0,y:0}),[k,g]=(0,s.useState)(40),v="tablesight-session-".concat(t),w=(0,s.useRef)(null),m=(0,s.useCallback)(e=>{if(e)try{let t=JSON.parse(e);if(t.isPlayerViewFrozen){p(t.playerZoom||1),y(t.playerPan||{x:0,y:0}),t.followedTokenId&&(l(t.tokens||[]),n(t.paths||[]),c(t.backgroundImage||null),g(t.cellSize||40));return}let a=(t.tokens||[]).map(e=>({...e,type:e.type||(e.id.startsWith("pc-")?"PC":"Enemy"),size:e.size||1,torch:e.torch||{enabled:!1,radius:5},hp:e.hp||("Enemy"===e.type?{current:10,max:10}:void 0)})),r=(t.paths||[]).map(e=>({...e,id:e.id||"path-".concat(Math.random()),isPortal:e.isPortal||!1,isHiddenWall:e.isHiddenWall||!1,points:e.points&&e.points.length>0&&Array.isArray(e.points[0])?e.points:[e.points||[]],isClosed:void 0!==e.isClosed?e.isClosed:"draw"!==e.tool}));l(a),n(r),c(t.backgroundImage||null),p(t.playerZoom||1),y(t.playerPan||{x:0,y:0}),g(t.cellSize||40)}catch(e){console.error("Failed to parse game state from localStorage",e)}},[]);return(0,s.useEffect)(()=>{if(!t)return;let e="tablesight-session-".concat(t);m(localStorage.getItem(e));let a=t=>{t.key===e&&m(t.newValue)};return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}},[t,m]),(0,s.useEffect)(()=>{let e=()=>{if(w.current){let{clientWidth:a,clientHeight:r}=w.current,s=localStorage.getItem(v);if(s)try{var e,t;let o=JSON.parse(s);((null==(e=o.playerViewport)?void 0:e.width)!==a||(null==(t=o.playerViewport)?void 0:t.height)!==r)&&(o.playerViewport={width:a,height:r},localStorage.setItem(v,JSON.stringify(o)))}catch(e){console.error("Could not update player viewport in storage",e)}}};e();let t=setTimeout(e,500);return window.addEventListener("resize",e),()=>{clearTimeout(t),window.removeEventListener("resize",e)}},[v]),(0,r.jsx)("div",{ref:w,className:"w-screen h-dvh bg-black relative flex items-center justify-center overflow-hidden",children:(0,r.jsx)("div",{className:"w-full h-full",children:(0,r.jsx)(o.v,{showGrid:!0,snapToGrid:!1,smartMode:!1,tokens:a,paths:i,backgroundImage:d,cellSize:k,onMapClick:()=>{},onNewPath:()=>{},onEraseLine:()=>{},onEraseBrush:()=>{},onTokenTorchToggle:()=>{},onPortalToggle:()=>{},selectedTool:"select",drawMode:"wall",eraseMode:"line",isPlayerView:!0,zoom:h,pan:u})})})}function i(){let[e,t]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=window.location.hash.substring(1);e?t(e):console.error("No session ID found in URL hash.")},[]),e)?(0,r.jsx)(l,{sessionId:e}):(0,r.jsx)("div",{children:"Loading session..."})}},335:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},1313:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("DoorOpen",[["path",{d:"M13 4h3a2 2 0 0 1 2 2v14",key:"hrm0s9"}],["path",{d:"M2 20h3",key:"1gaodv"}],["path",{d:"M13 20h9",key:"s90cdi"}],["path",{d:"M10 12v.01",key:"vx6srw"}],["path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z",key:"199qr4"}]])},2643:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Skull",[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]])},3153:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("DoorClosed",[["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14",key:"36qu9e"}],["path",{d:"M2 20h20",key:"owomy5"}],["path",{d:"M14 12v.01",key:"xfcn54"}]])},4607:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},5348:(e,t,a)=>{Promise.resolve().then(a.bind(a,188))},7569:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[769,822,441,684,358],()=>t(5348)),_N_E=e.O()}]);